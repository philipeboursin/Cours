\chapter{Dimension, espace tangent}
    \section{Topologie induite sur les ensembles algébriques}
        $\mathbb{A}_k^n$ est muni d'une topologie, dont les fermés sont les $V(I)$ pour $I$ un idéal de $k[X_1, \cdots, X_n]$. Ainsi on définit la topologie de Zariski sur $V \subseteq \mathbb{A}_k^n$ un esnemble algébrique comme la topologie induite sur $V$. Plus concrètement, les fermés de $V$ sont les $V(I) \cap V$, pour $I$ un idéal de $k[X_1, \cdots, X_n]$ (i.e. les ensembles algébriques $W \subseteq V$).
        \begin{exo}
            Les ouverts distingués $D(f)$ forment une base pour la topologie de zariski de $\mathbb{A}^n$.
        \end{exo}
        Ainsi $\{D(f) \cap V\}_f$ est une base des ouverts pour la topologie de Zariski sur $V$ un ensemble algébrique fixé.
        \begin{prop}
            Soient $V,W \subseteq \mathbb{A}^n, \mathbb{A}^l$. Tout morphisme $\varphi : V \to W$ est continu pour la topologie de zariski induite sur $V$ et $W$.
        \end{prop}
        \begin{proof}
            \ajout{
                Dans un premier temps, soit $f_i \in k[X_1, \cdots, X_n]$ tels que $\varphi(a) = (f_1(a), \cdots, f_i(a))$. Alors montrer que $\varphi$ est continue revient à montrer que $\tilde \varphi : \mathbb{A}^n \to \mathbb{A}^l$ définie par $\tilde \varphi(a) = (f_1(a), \cdots, f_i(a))$ pour tout $a \in \mathbb{A}^n$ est continue. En effet, soit $Z$ un fermé de $W$, alors $Z = Z' \cap W$ pour $Z$ un fermé de $\mathbb{A}^l$. Maintenant $\varphi^{-1}(Z) = \tilde \varphi^{-1}(Z') \cap V$ et est donc un fermé si et seulement si $\tilde \varphi^{-1}(Z')$ est un fermé. On peut donc se ramener au cas $\varphi : \mathbb{A}^n \to \mathbb{A}^l$. Ainsi considérons un fermé $V(J) \subrel{fermé} \mathbb{A}^l$, posons $I := k[\varphi](J)$, et montrons que $\varphi^{-1}(V(J)) = V(I)$.
                \item $\subseteq$ : soit $x \in \varphi^{-1}(V(J))$, alors pour tout $P \in I$, il existe $Q \in J$ tel que $P = k[\varphi](Q)$. Maintenant
                \begin{align*}
                    P(x) &= k[\varphi](Q)(x) = Q(\varphi(x)) = 0
                \end{align*}
                puisque $Q \in J$ et $\varphi(x) \in V(J)$.
                \item $\supseteq$ : Soit $x \in V(I)$, alors pour tout $Q \in J$, $k[\varphi](Q) \in I$ et donc
                \begin{align*}
                    Q(\varphi(x)) = k[\varphi](Q)(x) = 0 \\
                \end{align*}
                et donc $\varphi(x) \in V(J)$.
            }
        \end{proof}
        \begin{exo}
            Soit $f : X \to Y$ un morphisme dans $\mathbf{Top}$, si $X$ est irréductible, alors $\overline{f(X)}$ irréductible.
        \end{exo}
        \begin{expl}
            ($k = \bar k$) $f : \mathbb{A}^1 \to V := \{(x,y) \mid y^2 = x^3\}$ est surjectif, donc $V$ est irréductible.
        \end{expl}
        \begin{expl}
            $V = \{(x,y) \mid xy = 1\} \subseteq \mathbb{A}^2$. Notons $f : V \to \mathbb{A}^1$ la projection sur la première coordonnée, alors $f(V) = \mathbb{A}^1 \bs \{0\}$ n'est pas fermé (si $|k| = \infty$) et donc ne peut pas être un ensemble algébrique.
        \end{expl}
        \begin{exo}
            $E \subseteq \mathbb{A}^n_k$ ensemble quelconque, alors $\bar E = V(I(E))$. \ajout{Soit $E \subseteq V(J)$ un fermé Alors $J \subseteq I(V(J)) \subseteq I(E)$ et donc $V(I(E)) \subseteq V(J)$, ce qui prouve que $V(I(E)) = \bar E$.}
        \end{exo}

    \section{Variétés affines, dimension}
        \begin{defi} (Variété affine)
            Une variété affine est un ensemble algébrique affine irréductible.
        \end{defi}
        Ainsi si $V$ est une variété affine, alors $k[V] = k[X_1, \cdots, X_n]/I(V)$ est intègre (vu que $I(V)$ est un idéal premier).
        \subsection{Dimension d'une variété affine}
            \begin{defi}
                $k(V) := \mathrm{Frac}\, k[V]$ est le corps de fonctions rationnelles sur $V$.
                \begin{align*}
                    k(V) = \left\{ \frac{P}{Q} \mid P,Q \in k[V],\, Q \neq 0 \right\}
                \end{align*}
            \end{defi}
            \begin{defi} ($k = \bar k$)
                $V$ variété affine. On définit la dimension de $V$ par
                \begin{align*}
                    \mathrm{dim} V := \mathrm{trdeg}_k k(V)
                \end{align*}
                où $\mathrm{trdeg}_k k(V)$ est le degré de transcendance de $k(V)$ sur $k$.
            \end{defi}
            \begin{defi}
                $k \subseteq K$ extension de corps.
                \begin{enumerate}
                    \item Une partie $S \subseteq K$ est algébriquement indépendante si pour tout $m \geq 1$, tout $s_1, \cdots, s_m \in S$, si $P \in k[X_1, \cdots, X_m]$ est tel que $P(s_1, \cdots, s_m) = 0$, alors $P = 0$.
                    \item $S \subseteq K$ est une base de transcendance de $K$ (sur $k$) si $S$ est algébriquement indépendante et $k(S) \subseteq K$ est algébrique.
                    \item On dit que $k \subseteq K$ est purement transcendante si $\exists S$ base de transcendance $k \subseteq k(S) = K$.
                \end{enumerate}
            \end{defi}
            \begin{remq}
                Si $|S| = n$, alors $k(S) \simeq k(X_1, \cdots, X_n)$. Si $S_1,S_2$ sont deux bases de transcendance de $K/k$, alors $|S_1| = |S_2|$. 
            \end{remq}
            \begin{remq}
                $\dim V \leq n$ pour toute variété algébrique dans $\mathbb{A}^n$.
            \end{remq}
            \begin{defi}
                $\mathrm{trdeg}_k(K) = |S|$, $S$ base de transcendance de $K/k$.
            \end{defi}
            \begin{expl}
                \begin{enumerate}
                    \item $\dim \mathbb{A}_k^n = n$ : $V = \mathbb{A}_k^n$, $k[V] = k[X_1, \cdots, X_n]$. $I(V) = \{0\}$. Ainsi $k(V) = k(X_1, \cdots, X_n)$. Et $\{X_1, \cdots, X_n\}$ est une base de transcendance de $k(V)$, donc $\dim V = n$.
                    \item $V = \{(x,y) \mid xy = 1\} \subseteq \mathbb{A}^1$. Alors $V = V(XY - 1)$ est irréductible; Ainsi $V$ est une variété affine. $k[V] = k[X,Y]/(XY - 1) = k[x,y]$ où $x = [X]$, $y = [Y]$ (et $xy = 1$). $k(V) = \mathrm{Frac} (k[x,y]) =: k(x,y)$. Maintenant $k(x,y) = k(x)$ vu que $y = 1/x$. Maintenant $\{x\}$ est une base de trascendance de $k(x)$ : sinon il existe $P \in k[X]$ non nul tel que $P(x) = 0 \in k(x)$, et en particulier dans $k[x] \subseteq k[V]$. Ainsi $P \in I(V)$ donc $P(X) = (XY - 1)Q(X,Y)$ dans $k[X,Y]$ avec $Q \in k[X,Y]$, ce qui est absudre puisque $\deg_YP = 0$. Ainsi $\dim V = 1$
                \end{enumerate} 
            \end{expl}
            \begin{lemm}
                ($k = \bar k$) Soit $f \in k[X_1, \cdots, X_n]$ irréductible. Alors $V := V(f) \subseteq \mathbb{A}_k^n$ est une variété affine de dimension $n-1$.
            \end{lemm}
            \begin{proof}
                $f$ non constant. On peut supposer que $\deg_{X_n}(f) > 0$. Notons $k[V] = k[x_1, \cdots, x_n]$. Ainsi $f(x_1, \cdots, x_n) = 0$ vu que $I(V) = (f)$. . Maoitenant $k \subseteq k(x_1, \cdots, x_{n-1}) \subseteq k(x_1, \cdots, x_{n-1})(x_n)$ est algébrique car $f(x_1, \cdots, x_n) = 0$. Montrons que $\{x_1, \cdots, x_{n-1}\}$ sont algébriquement indépendants sur $k$ : si $g \in k[X_1, \cdots, X_{n-1}]$ tel que $g(x_1, \cdots, x_{n-1}) = 0$ dans $k(V)$ (donc dans $k[V]$). Alors $g(x_1, \cdots, x_{n-1}) \in I(V) = (f)$ mais $\deg_{X_n} g = 0$, absurde.
            \end{proof}
            \begin{remq}
                \label{rq113}
                Soient $f_1, \cdots, f_r \in k[X_1, \cdots, X_n]$, $V := V(f_1, \cdots, f_r) \subseteq \mathbb{A}^n_k$. Supposons que $V$ est irréductible, alors $\dim V \geq n-r$. \cor{Preuve en exercice}
            \end{remq}
            \begin{expl}
                $V := V(Y - X^2, Z - X^3, XZ - Y^2) \subseteq \mathbb{A}^3_k$. Alors $V = \{(t,t^2, t^3) \mid t \in k\}$ est une variété affine de dimension $1$ (on parle de courbe affine). En effet, $V$ est irréductible, puis $k[V] \simeq k[T]$ donc $\frac k[V] \simeq k(T)$ est de degré de transcendance $1$ sur $k$. Comme $V$ est définie par $3$ équations, $XZ - Y^2$ peut s'exprimer en fonction des deux autres polynômes et est donc superflue.
            \end{expl}
            \begin{remq}
                Si $V,W$ sont des variétés affines isomorphes, alors $k[V] \simeq k[W]$ et ainsi $k(V) \simeq k(W)$ donc $\dim V = \dim W$. Dans l'exemple précédente, on peut conclure que $V$ est de dimension $1$ avec cette remarque.
            \end{remq}
            \begin{expl}
                $V = V(XZ - Y^2 ,  XW - YZ, YW - Z^2) = V(f_1, f_2, f_3) \subseteq \mathbb{A}^4$. On sait que $\dim V \geq 1$ d'après la remarque \ref{rq113}. En fait, $\dim V = 2$, et $f_i \notin (f_j, f_l)$ pour tout $i,j,k$ différents deux à deux. Montrons par exemple que $f_3 \notin (f_1, f_2)$ : Soit $W = V(f_1, f_2)$, si $f_3 \in (f_1, f_2)$, alors $V = W$. Mais $V \cap \{x = 0\} \neq W \cap \{x = 0\}$ :
                \begin{align*}
                    &V \cap \{x = 0\} = \{(0,0,0,w) \mid w \in k\} \\
                    &W \cap \{x = 0\} = \{(0,0,z,w) \mid z,w \in k\} \\
                \end{align*}
                On peut montrer les autres de manière similaire, ainsi on ne peut pas éliminer d'équation, mais pourtant $\dim V = 2$ : Soit $V' = V(f_1)$, $V'' = V(f_1, f_2)$ ($V \subseteq V'' \subseteq V'$). Calculons la dimension de ces différentes variétés :
                \item 
                \begin{align*}
                    k[V'] = k[X,Y,Z,W]/(XZ - Y^2) = k[x,y,z,w]
                \end{align*}
                où $xz = y^2$. Alors $k(V') = k(x,y,z,w) = k(x,y,w)$ puisque $z = y^2/x$ dans $k(V')$. Enfin on peut prouver que $x,y,z$ sont algébriquement indépendants, et donc $\dim V' = 3$. 
                \item $k[V''] = k[x,y,z,w]$ avec $xz = y^2$, $sw = yz$. Ainsi $k(V'') = k(x,y)$ puisque $z = y^2/x$, $w = yz/x$, et on peut prouver que $x,y$ sont algébriquement indépendants, i.e. $\dim V'' = 2$. 
                \item $k(V) = k(x,y,z,w)$, mais $z = y^2/x$, $w = yz/x$, mais la $3$eme équation ne nous donne pas d'autre relation (c'est la même que celle donnée par la première équation). Il est donc possible de prouver que $x,y$ sont algébriquements indépendnts et alors $\dim V = 2$.
            \end{expl}

        \subsection{Dimension de krull}
            Soit $A \in \mathbf{CRings}$.
            \begin{defi} (Dimension de Krull)
                \begin{align*}
                    \dim A := \sup \{l \geq 0 \mid \mathfrak{p}_0 \nsubseteq \mathfrak{p}_1 \nsubseteq \cdots \nsubseteq \mathfrak{p}_l \subseteq A\}
                \end{align*}
            \end{defi}
            \begin{expl}
                \begin{enumerate}
                    \item $A = k[X_1, \cdots, X_n]$. Alors considérons $\mathfrak{p}_i = (X_1, \cdots, X_i)$ pour $0 \leq i \leq n$, on a donc $\dim A \geq n$. On peut en fait montrer que $\dim A = n$. 
                    \item La dimension d'un corps vaut $0$,
                    \item $\dim \mathbb{Z} = 1$.
                \end{enumerate}
            \end{expl}
            \begin{remq}
                $\mathfrak{p} \subseteq A$ idéal premier, alors
                \begin{align*}
                    \dim (A/\mathfrak{p}) = \sup \{l \geq 0 \mid \mathfrak{p} = \mathfrak{p}_0 \nsubseteq \cdots \nsubseteq \mathfrak{p}_l \}
                \end{align*}
            \end{remq}
            \begin{defi} (Hauteur)
                Soit $\mathfrak{p} \subrel{pr} A$, alors
                \begin{align*}
                    ht(\mathfrak{p}) = \sup \{s \geq 0 \mid \mathfrak{p}_0 \nsubseteq \cdots \nsubseteq \mathfrak{p}_s = \mathfrak{p} \}
                \end{align*}
            \end{defi}
            \begin{expl}
                \begin{enumerate}
                    \item $A = \mathbb{Z}$, alors $ht(p \mathbb{Z}) = 1$. 
                    \item $A = k[T]$, alors $ht((f)) = 1$.
                    \item $A = k[X_1, \cdots, X_n]$, $\mathfrak{p} = (X_1, \cdots, X_s)$. Alors $ht \mathfrak{p} = s$.
                \end{enumerate}
            \end{expl}
            \begin{theo}
                $k$ corps, $A$ $k$-algèbre de type fini. Soit $\mathfrak{p}$ idéal premier, alors 
                \begin{align*}
                    ht \mathfrak{p} + \dim A/\mathfrak{p} = \dim A
                \end{align*}
            \end{theo}
            \begin{expl}
                \begin{enumerate}
                    \item $A = \mathbb{Z}$, $\mathfrak{p} = p \mathbb{Z}$ avec $p$ premier; Alors $ht \mathfrak{p} = 1$, $\mathfrak{A}/p = \mathbb{F}_p$ est de dimension $0$.
                    \item $A = k[X_1, \cdots, X_n]$, $\mathfrak{p} = (X_1, \cdots, X_s)$ avec $s \in \lcc 1,n \rcc$. $ht \mathfrak{p} = s$, $A/\mathfrak{p} \simeq k[X_{s+1}, \cdots, X_n]$, $\dim A/\mathfrak{p} = n-s$.
                    \item La dimension peut être infinie : par exemple $A = k[\mathbb{N}]$.
                \end{enumerate}
            \end{expl}
            \begin{theo}
                Soit $V$ une variété affine. Alors
                \begin{align*}
                    \dim k[V] = \dim V
                \end{align*}
            \end{theo}

    \section{Singularités}
        \subsection{Points singuliers, variétés lisses}
            Soit $V \subseteq \mathbb{A}^n_k$ une variété affine. Notons $d = \dim V$, et soit $I(V) = (P21, \cdots, P_r) \subrel{id} k[X_1, \cdots, X_n]$. On a $d \geq n - r$. Considérons le morphisme
            \begin{align*}
                \begin{array}{cccc}
                    \varphi : & \mathbb{A}^n & \to & \mathbb{A}^r \\
                    & x & \mapsto & (P_1(x), \cdots, P_r(x)) \\
                \end{array}
            \end{align*}
            En particulier, $\varphi_{|V} = 0$.
            \begin{nota}
                On note
                \begin{align*}
                    d \varphi (x) = 
                    \begin{bmatrix}
                        \frac{\partial P_1}{\partial X_1}(x) & \cdots & \frac{\partial P_1}{\partial X_n}(x) \\
                        \vdots & & \vdots \\
                        \frac{\partial P_r}{\partial X_1}(x) & \cdots & \frac{\partial P_r}{\partial X_n}(x) \\
                    \end{bmatrix}
                    \in M_{r, n}(k)
                \end{align*}
                la matrice jacobienne de $\varphi$ en $x$.
            \end{nota}
            \begin{defi}
                $a \in V$ est un point régulier (ou encore non singulier) de $V$ si 
                \begin{align*}
                    rk (d \varphi(a)) = n - d
                \end{align*}
                Si $rk (d \varphi(a)) < n - d$, on dit que $a$ est un point singulier de $V$.
            \end{defi}
            \begin{remq}
                \begin{enumerate}
                    \item $\forall a \in V$, $rk (d \varphi(a)) \leq n - d$
                    \item La définition précédente ne dépend pas du choix de $P_1, \cdots, P_r$
                \end{enumerate}
            \end{remq}
            \begin{defi}
                $V$ est lisse si $\forall a \in V$, $a$ est un point régulier.
            \end{defi}
            \begin{expl}
                \begin{enumerate}
                    \item $\mathbb{A}^n$ est lisse.
                    \item $V = V(f) \subseteq \mathbb{A}^n$, pour $f \in k[X_1, \cdots, X_n]$ irréductible est une variété affine de dimension $n-1$?. Alors
                    \begin{align*}
                        d \varphi =
                        \begin{bmatrix}
                            \frac{\partial f}{X_1}, \cdots, \frac{\partial f}{X_n}
                        \end{bmatrix}
                    \end{align*}
                    Ainsi $a \in V(f)$ est singuler ssi $rk (d \varphi(a)) = 0$ ssi $\frac{\partial f}{X_1}(a) = \cdots = \frac{\partial f}{X_n}(a) = 0$.
                    \item Si $f = XY - 1$, $V = V(f) \subseteq \mathbb{A}^2$. Alors $\frac{\partial f}{X} = Y$ et $\frac{\partial f}{Y} = X$, alors $a \in V$ singulier si $a_2 = a_1 = 0$, mais $a \in V \iff a_1a_2 = 1$, donc tout point de $V$ est régulier et $V$ est donc lisse.
                    \item $f = Y^2 - X^3$, $V := V(f) \subseteq \mathbb{A}^2$. Si $char \, k \neq 2,3$, alors $a \in V$ singulier ssi $a = (0,0)$. 
                    \item $f = Y^2 - X(X-1)(X - \lambda)$, $\lambda \in k$ ("courbe ellipitique" si $\lambda \neq 0,1$). $f = Y^2 - X^3 + (\lambda + 1)X^2 - \lambda X$. Alors
                    \begin{align*}
                        & \frac{\partial f}{\partial X} = -3X^2 + 2(\lambda + 1)X - \lambda \\
                        & \frac{\partial f}{\partial Y} = 2Y \\
                    \end{align*}
                    et donc $(a,b) \in V(f)$ singulier ssi
                    \begin{align*}
                        &\begin{cases}
                        -3x^2 + 2(\lambda + 1)x - \lambda = 0 \\
                        2y = 0 \\
                        y^2 = x(x-1)(x - \lambda) \\
                        \end{cases}
                        &\iff 
                        \begin{cases}
                            y = 0 \\
                            x = 0,1,\lambda \\
                            -3x^2 + 2(\lambda + 1)x - \lambda = 0 \\
                        \end{cases}
                    \end{align*}
                    Alors
                    \begin{enumerate}
                        \item Si $x = 0$, $\lambda = 0$ et $(0,0)$ est le seul point singulier.
                        \item Si $x = 1$, alors $\lambda = 1$ et $(1,0)$ est le seul point singulier.
                        \item Si $x = \lambda$, alors $\lambda = 0,1$ et donc c'est les cas précédents.
                    \end{enumerate}
                    Ainsi si $\lambda \neq 0,1$, alors $V(f)$ est lisse.
                \end{enumerate}
            \end{expl}

    \section{Anneau des fonctions régulières en un point}
        Soit $V \subseteq \mathbb{A}^n_k$ une variété affine, $a \in V$. Par définition,
        \begin{align*}
            k[V] = \frac{k[X_1, \cdots, X_n]}{I(V)}
        \end{align*}
        puis $k(V) = \Frac k[V]$.
        \begin{defi}
            $\alpha \in k(V)$ est bien définie au point $a \in V$ si $\exists f,g \in k[V]$ telles que $\alpha = f/g \in k(V)$ et $g(a) \neq 0$. Dans ce cas, la valeur de $\alpha$ en $a$ est définie comme $\alpha(a) := f(a)/g(a) \in k$.
        \end{defi}
        \begin{remq}
            En général, pour $\alpha \in k(V)$, on peut toujours écrire $\alpha = f/g$ mais $f$ et $g$ ne sont pas uniques.
        \end{remq}
        \begin{expl}
            $V = V(Y^2 - X^3) \subseteq \mathbb{A}^2$; Alors $k[V] = k[x,y]$ avec $y^2 = x^3$. Alors 
            \begin{align*}
                \frac yx = \frac{x^2}y \in k(V)
            \end{align*}
        \end{expl}
        \begin{prop}
            Soit $\alpha \in k(V)$ bien définie en $a \in V$. Alors $\alpha(a)$ est bien définie.
        \end{prop}
        \begin{proof}
            Si $\alpha = f/g = f'/g'$ avec $f,g,f',g' \in k[V]$ et $g(a), g'(a) \neq 0$. Alors $fg' - f'g = 0 \in k[V]$ et donc $f(a)g'(a) - f'(a)g(a) = 0$, ce qui implique que
            \begin{align*}
                \frac{f(a)}{g(a)} = \frac{f'(a)}{g'(a)} \in k
            \end{align*}
        \end{proof}
        \begin{nota}
            \begin{align*}
                k[V]_a := \{\alpha \in k(V) \mid \alpha \text{ est définie en } a \}
            \end{align*}
            C'est un sous anneau de $k(V)$, dit anneau local de fonctions régulières autour de $a$.
        \end{nota}
        \begin{remq}
            \begin{enumerate}
            \item $k \subseteq k[V] \subseteq k[V]_a \subseteq k(V)$
            \item $a \in V \iff I(V) \subseteq \mathfrak{m}_a$. Si $g \in k[V]$, $g(a) = 0 \iff g \in \mathfrak{m}_a/I(V) \subrel{max} k[V]$.
            \item $k[V]_a$ est la localisation de $k[V]$ en $S = A \bs \mathfrak{p}$, où $\mathfrak{p} = \mathfrak{m}_a/I(V)$. 
            \end{enumerate}
        \end{remq}

        \subsection{Anneaux locaux}
            Rappelons que si $A$ est un anneau, $S = A \bs \mathfrak{p}$, l'image $S^{-1} \mathfrak{p}$ de $\mathfrak{p}$ par le morphisme canonique $A \to S^{-1}A$ est l'unique idéal maximal de $S^{-1}A$. En effet, $S^{-1} A \bs S^{-1}\mathfrak{p}$ sont des inversibles de $S^{-1}A$. Ainsi $S^{-1}A$ est un anneau local. 
            \begin{nota}
                On notera $(A, \mathfrak{m})$ les anneaux locaux, avec $\mathfrak{m}$ leur unique idéal maximal. $A/\mathfrak{m}$ est le corps résiduel de $A$.
            \end{nota}
            \begin{prop}
                Soit $A$ un anneau noethérien intègre, $S \subseteq A$ un ensemble multiplicatif. Alors $S^{-1}A$ est noethérien.
            \end{prop}
            \begin{proof}
                Soit $I \subrel{id} S^{-1}A$. Ainsi le morphisme $\varphi : A \to S^{-1}A$ est injectif. Alors $J := \varphi^{-1}(I)$ est un idéal de $A$, qui est de type fini. Ainsi il existe $P_1, \cdots, P_r \in J$ tel que $J = (P_1, \cdots, P_r)$. Montrons que $I = (\varphi(P_1), \cdots, \varphi(P_r)) = (P_1/1, \cdots, P_r/1)$. Soit $a/s \in I$, alors 
                \begin{align*}
                    \varphi(a) = \frac a1 = \frac as \frac S1
                \end{align*}
                donc il existe $f_1, \cdots, f_r \in A$ tq $a = \sum f_i P_i \in A$. Et donc
                \begin{align*}
                    \frac as = \sum \frac{f_i}s \frac{P_i}1
                \end{align*}
                et donc $a/s \in (P_1/1, \cdots, P_r/1)$.
            \end{proof}
            \begin{coro}
                Soit $V$ une variété algébrique. Alors $k[V]_a$ est un anneau noethérien.
            \end{coro}
            \begin{proof}
                $k[V]$ est noethérien et intègre car $V$ est une variété algébrique. Ainsi $k[V]_a$ est noéthérien comme localisation de $k[V]$.
            \end{proof}
            \begin{lemm} (Nakayama)
                $(A, \mathfrak{m})$ anneau local noethérien, et $M$ un $A$-module de type fini. Si $\mathfrak{m} M = M$, alors $M = 0$.
            \end{lemm}
            \begin{coro}
                $\mathfrak{m}^i/ \mathfrak{m}^{i+1} = 0 \iff \mathfrak{m}^i = 0$. En particulier, $\mathfrak{m}/\mathfrak{m}^2 = 0 \iff \mathfrak{m} = 0 \iff A$ est un corps.
            \end{coro}
            \begin{remq}
                Soit $(A, \mathfrak{m})$ un anneau local noethérien. $\mathfrak{m}/\mathfrak{m}^2$ est un $A$-module, mais aussi un $k$-ev où $k = A/\mathfrak{m}$ de type fini (en tant que $A$-module et en tant que $k$-ev)
            \end{remq}
            \begin{theo}
                $(A, \mathfrak{m})$ anneau local noethérien, $k = A/\mathfrak{m}$. Alors
                \begin{align*}
                    \dim_k \mathfrak{m}/\mathfrak{m}^2 \geq \dim A
                \end{align*}
                où $\dim A$ est la dimension e krull de $A$. De plus, si on a égalité (on note $d = \dim A$), alors $\mathfrak{m} = (x_1, \cdots ,x_d)$ avec $x_i \in A$, et on dit que $(A, \mathfrak{m})$ est un anneau régulier.
            \end{theo}
        
    \section{Espace tangent}
        Soit $V$ une variété affine, $a \in V$, on note $A = k[V]_a$. L'idéal maximal de $A$ est $\mathfrak{m} = \{\alpha \in A \mid \alpha(a) = 0\}$.
        \begin{exo}
            Considérons le morphisme
            \begin{align*}
                \begin{array}{cccc}
                    ev : & k[V]_a & \to & k \\
                    & \alpha & \mapsto & ev(\alpha) = \alpha(a) \\
                \end{array}
            \end{align*}
            Alors $\ker(ev) = \mathfrak{m}$ idéal maximal de $k[V]_a$, et $k[V]_a/\mathfrak{m} \simeq k$
        \end{exo}
        
        \subsection{Espace tangent de Zariski}
            \begin{defi}
                $V \subseteq \mathbb{A}^n$ variété affine, $a \in V$. Soit $A = k[V]_a$ l'anneau local associé à $a$. L'espace tangent de $V$ en $a$ est le $k$-ev
                \begin{align*}
                    T_aV := (\mathfrak{m}/ \mathfrak{m}^2)^{\vee} := \Hom_k(\mathfrak{m}/ \mathfrak{m}^2, k)
                \end{align*}
                l'espace tangent à $V$ en $a$.
            \end{defi}
            \begin{theo}
                \cor{
                    $\dim k[V] = \dim k[V]_a$
                }
            \end{theo}
            Donc $(A, \mathfrak{m})$ est régulier ssi $\dim V =\dim A = \dim_k \mathfrak{m}/ \mathfrak{m}^2 = \dim_k T_aV$. On va montrer que $(A, \mathfrak{m})$ est régulier si et seulement si $a \in V$ est régulier.
            \begin{theo}
                $\dim_k T_aV \geq \dim V$ avec égalité si et seulement si $a \in V$ est un point régulier.
            \end{theo}
            Pour montrer ce théorème, nous devons parler d'espace tangent géométrique.
        
        \subsection{Espace tangent géométrique}
            Soit $V = V(P_1, \cdots, P_r) \subseteq \mathbb{A}^n$, avec $P_1, \cdots, P_r \in k[X_1, \cdots, X_n]$, et $a \in V$.
            \begin{defi} (Espace tangent géométrique)
                L'espace tangent géométrique de $V$ en $a$ est définit comme
                \begin{align*}
                    T_a^\mathrm{geom} V = V(P^1_1, \cdots, P_r^1) \subseteq \mathbb{A}^n
                \end{align*}
                où 
                \begin{align*}
                    P_i^1 = \sumç_{j = 1}^n \frac{\partial P_i}{\partial X_j}(a) (X_j - a_j)
                \end{align*}
            \end{defi}
            \begin{remq}
                Soit $P \in k[X_1, \cdots, X_n]$, on peut décomposer $P$ en $P = \sum_{i = 0}^d P^i$ où les $P^i$ sont des polynômes homogènes de degré $i$ (tous les monômes sont de la forme $X^\alpha$ avec $|\alpha| = i$) en réalisant l'expansion de taylor de $P$ en $0$. Ainsi, 
                \begin{align*}
                    P^1 = \sum_{j = 1}^n \frac{\partial P}{\partial X_j}(0) X_j
                \end{align*}
                Maintenant si $a \in \mathbb{A}^n$, alors on peut réaliser l'expansion de taylor de $P$ en $a$, $P = \sum P^i$, et alors
                \begin{align*}
                    P^1 = \sum_{j = 1}^n \frac{\partial P}{\partial X_j}(a) (X_j - a_j)
                \end{align*}
            \end{remq}
            \begin{expl}
                \begin{enumerate}
                    \item Soit $V = \{(x,y) \mid y^2 = x\} \subseteq \mathbb{A}^2$. Alors $V = V(P)$ avec $P = Y^2 - X$. Alors soit $a = (a_1, \cdots, a_2) \in V$ (donc $a_2^2 = a_2$), on a 
                    \begin{align*}
                        &\frac{\partial P}{\partial X} = -1 \\
                        &\frac{\partial P}{\partial Y} = 2Y \\
                    \end{align*}
                    On a donc 
                    \begin{align*}
                        T_a^\mathrm{geom} = V(-(X - a_1) + 2a_2(Y - a_2))
                    \end{align*}
                    est la droite tangente au point $(a_1, a_2)$, qui est isomorphe à $k$. En effet, $\dim T_a^\mathrm{geom} = 1$ (c'est le translaté d'un sous-espace de $k^2$ de dimension $1$). De même, $\dim V = 1$ vu que $k[V] = k[Y]$, puis $V$ est lisse donc tout point est régulier.
                    \item Cas particulier : $a = (0,0)$, alors $T_a^\mathrm{geom} V = V(x)$. Maintenant $k[V] \simeq k[X]$, et $k[V]_a = k[x,y]_{(x,y)} \simeq k[x]/(x)$. Finalement, $\mathfrak{m} = (X/1)$ et donc $\dim_k \mathfrak{m}/\mathfrak{m}^2 = 1$ ($X/1$ est une base de ce $k$-ev). Ainsi $\dim T_aV = 1$ en $0$.
                \end{enumerate}
            \end{expl}
            Soit $a \in V$, considérons l'application
            \begin{align*}
                \begin{array}{cccc}
                    \tau_a : & \mathbb{A}^n & \to & \mathbb{A}^n \\
                    & x & \mapsto & x - a \\
                \end{array}
            \end{align*}
            C'est un isomorphisme, et alors on peut considérer l'image par $\tau_a$ de $T_a^\mathrm{geom}V$. On va montrer que c'est un $k$-ev isomorphe à $T_a(V)$ l'espace tangent de Zariski. On va ensuite montrer que $\dim T_a^\mathrm{geom}V = n - rk d\varphi(a)$. Rappelons que pour tout $a \in V$, $rk d\varphi(a) \leq n-d$ avec $d = \dim V$, avec égalité ssi $a$ est un point régulier. Ainsi les deux points précédent nous permettent de conclure que $\dim T_aV = \dim T_a^\mathrm{geom}V \geq d$ avec égalité si et seulement si $a$ est un point régulier.
            % \begin{theo}
            %     $(A, \mathfrak{m})$ anneau local noethérien, alors 
            %     \begin{align*}
            %         \dim_j \mathfrak{m}/\mathfrak{m}^2 \geq \dim A
            %     \end{align*}
            %     avec égalité si et seulement si $m = (x_1, \cdots, x_d)$ avec $d = \dim A$ (dans ce cas on dit que $(A, \mathfrak{m})$ est un anneau régulier)
            % \end{theo}
            \begin{expl}
                $k = \bar k$, $char k = 0$. Soit $V = V(Y^2 - X^3) \subseteq \mathbb{A}^2$, on a $\dim V = 1$. Ainsi
                \begin{align*}
                    &\frac{\partial P}{\partial X} = -3X^2 \\
                    &\frac{\partial P}{\partial Y} = 2Y \\
                \end{align*}
                Alors $(a,b) \in V$ est singulier si et seulement si $(a,b) = 0$. Maintenant soit $(a,b) \in V$, alors
                \begin{align*}
                    T_a^\mathrm{geom}V = \{(x,y) \in \mathbb{A}^2 \mid -3a^2(x-a) + 2b(Y - b) = 0\}
                \end{align*}
                droite dans $\mathbb{A}^2$ si $(a,b) \neq 0$. Si $(a,b) = 0$, alors $T_0^\mathrm{geom}V = \mathbb{A}^2$ est de dimension $2$. On peut aussi calculer l'espace tangent de Zariski :
                \begin{align*}
                    K[V]_{(a,b)} &= \left( k[X,Y]/(Y^2 - X^3) \right)_{(X-a, Y-b)} \\
                    &= k[x,y]_{(x-a, y-b)} \\ 
                    &= \left\{ \frac PQ \mid P,Q \in k[x,y],\, Q(a,b) \neq 0 \right\}
                \end{align*}
                Alors on peut voir que $\mathfrak{m}_{(a,b)} = (x-a,y-b) \subseteq K[V]_{(a,b)}$. Maintenant $(x-a, y-b)$ engendre $\mathfrak{m}/\mathfrak{m}^2$ en tant que $k$-ev, donc $\dim_k \mathfrak{m}/\mathfrak{m}^2 \leq 2$. Maintenant si $(a,b) \neq 0$, alors $\{x-a, y-b\}$ n'est pas libre modulo $\mathfrak{m}^2$ : en effet, dans $k[x,y]$,
                \begin{align*}
                    3a^2(x-a) - 2b(y-b) = (y - b)^2 - 3a(x - a)^2 - (x - a) ^3 \in \mathfrak{m}^2
                \end{align*}
                et $3a, 2b \neq 0,0$. Maintenant, si $(a,b) = 0$, alors $\mathfrak{m} := \mathfrak{m}_0 = (x,y)$, montrons que $\{x,y\}$ est libre sur $k$ modulo $\mathfrak{m}^2$. Soient $\alpha, \beta \in k$ tels que $\alpha x + \beta y = 0$ mod $\mathfrak{m}^2$. Ainsi $\alpha x + \beta y \in \mathfrak{m}^2 \subseteq k[V]_0$, et donc il existe $P_i/Q_i \in k[V]_0$ avec 
                \begin{align*}
                    \alpha x + \beta y = \frac{P_1}{Q_1}x^2 + \frac{P_2}{Q_2}xy + \frac{P_3}{Q_3}y^2
                \end{align*}
                dans $k[V]_0$. Maintenant $Q_i(0) \ne 0$, donc $\exists Q \in k[x,y]$ tel que $Q(0) \neq 0$ et $Q(\alpha x + \beta y) \in (x^2, xy, y^2)$ dans $k[x,y]$ cette fois. Ainsi $\exists R_i \in k[x,y]$ tels que 
                \begin{align*}
                    Q(X,Y)(\alpha X + \beta Y) - R_1X^2 - R_2XY - R_3Y^2 \in I(V) = (Y^2 - X^3)
                \end{align*}
                dans $k[X,Y]$. Ainsi $Q(X,Y)(\alpha X + \beta Y) \in (X^2, XY, Y^2)$ car $Y^2 - X^3 \in (X^2, XY, Y^2)$. Remarquons qu'en général, si $P \in k[X_1, \cdots, X_n]$, alors $P^0 = 0 \iff P \in (X_1, \cdots, X_n)$, $P^0 = P^1 = 0 \iff P \in (X_1, \cdots, X_n)^2$. Mais alors $Q$ a un terme constant car $Q(0) = 0$, et donc le terme linéaire de $Q(\alpha X + \beta Y)$ doit etre $Q^0(\alpha X + \beta Y)$ et doit être $0$ car $Q(\alpha X + \beta Y) \in (X,Y)^2$. Ainsi $Q^0\alpha, Q^0 \beta = 0 \in k$ et donc $\alpha, \beta = 0$ ce qui prouve la liberté de $\{x,y\}$.
            \end{expl}
            \begin{remq}
                $\mathfrak{m}_a/\mathfrak{m}_a^2 \simeq M_a/M_a^2$ où $M_a = \ker ev_a : k[V] \to k \subrel{id} k[V]$.
            \end{remq}
            Soit $a \in V$, notons
            \begin{align*}
                H_\alpha := \{x \in \mathbb{A}^n \mid \sum \alpha^j (x_j - a_j) = 0\} \subseteq \mathbb{A}^2
            \end{align*}
            Remarquons alors que $a \in H_\alpha$. Alors on a
            \begin{align*}
                \tau_a(H_\alpha) = \{z \in \mathbb{A}^n \mid \sum \alpha^jz_j = 0\} \subseteq \mathbb{A}^n
            \end{align*}
            et c'est un sev de $k^n$. Ainsi 
            \begin{align*}
                \tau_a(T_a^\mathrm{geom}V) = \{z \in k^n \mid \forall i \in \lcc 1,r \rcc,\, \sum_j \frac{\partial P_i}{\partial X_j}(a) z_x = 0\}
            \end{align*}
            Si $V = V(P_1, \cdots, P_r)$. C'est le noyau de l'application $k^n \to k^r$ correspondant à la matrice jacobienne $d \varphi(a)$, et ainsi $\dim T_a^\mathrm{geom}V = n - rk d \varphi(a)$. \\
            Montrons maintenant que $\tau_a(T_a^\mathrm{geom}V) \simeq T_aV$ en tant que $k$-ev. On peut supposer que $a = 0 \in \mathbb{A}^n_k$, montrons que 
            \begin{align*}
                \Hom_k(T_a^\mathrm{geom}V, k) \simeq \mathfrak{m}/\mathfrak{m}^2
            \end{align*}
            On note $x_i = [X_i] \in k[V]$, $M = (x_1, \cdots, x_n)$.
            \begin{exo}
                $\mathfrak{m}/\mathfrak{m}^2 \simeq M/M^2$ en tant que $k$-ev ($\mathfrak{m}$ est l'image de $M$ par $k[V] \to k[V]_a$ où $M = (x_i - a_i)$) 
            \end{exo}
            Aisni prouver le point précédent reviens a prouver qu'il existe un isom
            \begin{align*}
                M/M^2 \simeq \Hom_k(T_a^\mathrm{geom}V, k) 
            \end{align*}
            Notons ainsi $V = V(P_1, \cdots, P_r)$, $W := T_a^\mathrm{geom}V$. Comme $a = 0 \in V$, alors $P_i(0) = 0$ pour tout $i$. Alors soit
            \begin{align*}
                \begin{array}{cccc}
                    \varphi : & M & \to & \Hom_k(W,k) \\
                    & [P] & \mapsto & P^1_{|W} : x \in W \mapsto P^1(x) \in k \\
                \end{array}
            \end{align*}
            \begin{enumerate}
                \item Montrons que $\varphi$ est bien définie : soient $P,Q \in k[X_1, \cdots, X_n]$ tels que $[P] = [Q]$, alors $P - Q \in I(V)$. Mais écrivons $P,Q = P^1,Q^1 + \cdots + P^d,Q^e$ avec $P^i,Q^j$ homogènes. Alors $P-Q = (P^1 - Q^1) + \cdots$ et $(P - Q)^1 = P^1 - Q^1$. Maintenant $P - Q \in I(V) \Rightarrow P^1 - Q^1 \in I(W)$ et donc $P^1 - Q^1$ est nul sur $W$. Précisons l'implication précédente : si $R \in I(V)$, alors $R^1 \in I(W)$. EN effet, écrivons $R = \sum P_iQ_i$, puis écrivons $P_i = P_i^1 + P_i^2 + \cdots$, $Q_i = Q_i^0 + Q_i^1 + \cdots$. Mais alors $(P_iQ_i)^1 = P_i^1Q_i^0$ donc $R^1 = \sum P_i^1Q_i^0 \in I(W)$.
                \item Montrons que $\varphi$ est surjective. Soit $f : W \to k$ $k$-linéaire. Alors $\exists \tilde f : k^n \to k$ $k$-linéaire telle que $\tilde f_{|W} = f$, puis 
                \begin{align*}
                    \tilde f(x) = \sum \alpha_i x_i
                \end{align*}
                Ainsi $\varphi([\sum \alpha_i X_i]) = \tilde f_{|W} = f$.
                \item Montrons que $\ker \varphi = M^2$ : \cor{flemme}   
            \end{enumerate}

    \section{Courbes algébriques affines}
        $k$ corps algébriquement clos. Une courbes est une variété affine de dimension $1$. $a \in C$ dans une courbe est régulier ssi $\dim \mathfrak{m}_a/\mathfrak{m}_a^2 = 1$.
        \begin{defi}
            Un anneau de valuation discrète (DVR) est un anneau local $(A, \mathfrak{m})$ tel que $A$ intègre et principal, et pas un corps;
        \end{defi}
        En particulier, un tel anneau est
        \begin{enumerate}
            \item noethérien
            \item $\mathfrak{m} = (t)$ (on appelle $t \in A$ une uniformisante). Un tel $t$ est irréductible.
            \item factoriel 
            \item $\dim A = 1$ \\
        \end{enumerate}
        \begin{prop}
            $(A, \mathfrak{m})$ DVR, $K = \Frac A$, $\mathfrak{m} = (t)$.
            \begin{enumerate}
                \item Les idéaux non nuls de $A$ sont les $\mathfrak{m}^i = (t^i)$, $i \in \mathbb{N}$.
                \item $\bigcap_{i \geq 0} \mathfrak{m}^i = \{0\}$
                \item $\forall x \in k \bs 0$, $\exists ! n \in \mathbb{Z}$ tel que $x = t^nu$, $u \in A^\times$ et l'application
                \begin{align*}
                    \begin{array}{cccc}
                        v : & K \bs 0 & \to & \mathbb{Z} \\
                        & x & \mapsto & v(x) = n \\
                    \end{array}
                \end{align*}
                satisfait 
                \begin{align*}
                    \begin{cases}
                        v(xy) = v(x) + v(y) \\
                        v(x + y) \geq \min \{v(x), v(y)\} \\
                    \end{cases}
                \end{align*}
                ($v$ est une valuation de $K$)
            \end{enumerate}
            De plus,
            \begin{align*}
                &A = \{x \in k \bs 0 \mid v(x) \geq 0\} \cup \{0\} \\
                &\mathfrak{m} = \{x \in k \bs 0 \mid v(x) > 0\} \cup \{0\} \\
            \end{align*}
        \end{prop}
        \begin{exo}
            Si $v : K \bs 0 \to \mathbb{Z}$ est une valuation d'un corps $K$, alors $A = \{x \in K \bs 0 \mid v(x) \geq 0\} \cup \{0\}$ est un DVR d'idéal maximal $\{x \in K \bs 0 \mid v(x) > 0\} \cup \{0\}$.
        \end{exo}
        \begin{proof}
            \begin{enumerate}
                \item $A$ factoriel, $t$ irréductible. Pour tout $x \in A \bs 0$, $\exists N \geq 0$ maximal avec la propriété que $t^N \mid x$ dans $A$. Alors $x = t^Ny$, $y \in A^\times$ (vu que $A$ est local donc $A^\times = A \bs \mathfrak{m}$, et $N$ est maximal). Maintenant soit $I \subrel{id} A$ idéal, alors $\exists x \in A$ non nul tq $I = (x)$; Alors on a que $x = t^Ny$ avec $y \in \mathbb{A}^x$, et donc $I = (t^N)$.
                \item On a $0 \subseteq \mathfrak{m}^i \nsubseteq \mathfrak{m}^{i-1} \subseteq A$. Alors soit $x \in \bigcap_{\mathbb{N}} \mathfrak{m}^i$ non nul. Alors $x = t^Ny$, $y \in A^\times$. Mais $x \in \mathfrak{m}^{N+1}$ donc $t^{N+1} \mid t^Ny$ absurde.
                \item Soit $x \in K \bs 0$. Alors $x = y/z$, $y,z \in A$ et $z \neq 0$. Alors $\exists N,M \in \mathbb{N}$ t.q. $y = t^Nu$, $z = t^Mv$ avec $u,v \in A^\times$. Ainsi $x = t^{N-M}(uv^{-1})$. Maintenant vérifions que la valuation est bien définie : si $x = t^iu = t^jv$, alors ops $i > j$ et alors $t^{i-j} \in \mathbb{A}^\times$, absurde. Anis $i = j$ et $u = v$. Il est finalement facile de voir que $v$ est une valuation.
            \end{enumerate}
        \end{proof}
        \begin{theo}
            $C$ courbe, $a \in C$. Alors $a \in C$ est un point régulier ssi $k[V]_a$ est un DVR.
        \end{theo}
        \begin{theo}
            $C$ courbe affine. $C$ est lisse ssi $k[C]$ est untégralement clos dans $k(C)$.
        \end{theo}
        \begin{defi}
            $A$ anneau intègre, $K = \mathrm{Frac} A$. Alors
            \begin{enumerate}
                \item $x \in K$ est entier sur $A$ s'il existe $P \in A[X]$ unistaire tel que $P(x) = 0$ (dans $K$).
                \item $A$ intégralement clos dans $K$ si $x \in K$ entier sur $A$ implique que $x \in A$.
            \end{enumerate}
        \end{defi}
        \begin{expl}
            \begin{enumerate}
                \item $\mathbb{Z}$ est intégralement clos dans $\mathbb{Q}$.
                \item $\mathbb{Z}[i]$ est intégralement clos dans $\mathbb{Q}$.
                \item $A = k[X,Y]/(Y^2 - X^3) = k[x,y]$ n'est pas intégralement clos. Par exemple, $y/x$ est entier sur $A$ car $(y/x)^2 - x = 0$ mais pas dans $A$.
            \end{enumerate}
        \end{expl}
        \begin{theo}
            $A$ intègre. $A$ intégralement clos ssi $A_\mathfrak{p}$ est intégralement clos, pour tout $\mathfrak{p} \subrel{premier} A$.
        \end{theo}
        \begin{theo}
            $A$ anneau local intègre, $\dim A = 1$. Alors $A$ intégralement clos ssi $A$ est un DVR
        \end{theo}
        \begin{defi}
            $A$ anneau de dedekind si intègre, noeth, intégralement clos, de dimension $1$.
        \end{defi}
        \begin{expl}
            $\mathbb{Z}$, $\mathbb{Z}[i]$, $k[C]$ pour $C$ une courbe lisse.
        \end{expl}
        \begin{theo}
            $C$ courbe affine.
            \begin{align*}
                Sing(C) = \{a \in C \mid a \text{ singulier} \}
            \end{align*}
            est un ensemble propre de $C$
        \end{theo}
        \begin{exo}
            $Sing(C)$ est un sous-ensemble algébrique.
        \end{exo}
        \begin{prop}
            $C$ courbe affine. Les sous-ensemblers propres de $C$ sont finis.
        \end{prop}
        \begin{coro}
            $|Sing(C)| < \infty$
        \end{coro}
        \begin{proof} (proposition)
            Soit $V \subseteq C \subseteq \mathbb{A}^n$ ensemble algébrique propre. OPS $V$ irréductible(sinon on considère une composante de $V$). Alors $V \nsubseteq C$ implique que $I(C) \nsubseteq I(V) \subseteq k[X_1, \cdots, X_n]$. Montrons que $I(V) = \mathfrak{m}_a$, $a \in \mathbb{A}^n$. Maintenant
            \begin{align*}
                0 \subseteq I(V)/I(C) \subseteq k[C]
            \end{align*}
            est un idéal premier. Mais $\dim k[C] = 1$, donc $I(V)/I(C)$ est maximal, donc $I(V)$ maximal. Ainsi $I(V) = \mathfrak{m}_a$ car $k = \bar k$, donc $V$ doit être un point.
        \end{proof}